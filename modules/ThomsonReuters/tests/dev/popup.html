<!doctype html>
<html>
<head>
	<title>Kaltura Player</title>
	<script type="text/javascript" src="../../../../mwEmbedLoader.php"></script>
</head>
<body>
	<div class="tr-top-bar">
		<div class="tr-top-logo">REUTERS&nbsp;<span class="tr-logo-sub">INSIDER</span></div>
	</div>
	<div class="right-container"><!-- render transcript plugin to this div --></div>	
	<div class="left-container">
		<div class="player-buttons">
			<!-- render player-actions plugin to this div -->
		</div>
		<div id="kPlayer" style="height: 410px;"></div>
	</div>
<script>
// Force HTML5 player
mw.setConfig('forceMobileHTML5', true);


//parse query string to an object
var QueryString = function () {
    var query_string = {};
    var query = window.location.search.substring(1);
    var vars = query.split("&");
    for (var i=0;i<vars.length;i++) {
        var pair = vars[i].split("=");
        // If first entry with this name
        if (typeof query_string[pair[0]] === "undefined") {
            query_string[pair[0]] = pair[1];
            // If second entry with this name
        } else if (typeof query_string[pair[0]] === "string") {
            var arr = [ query_string[pair[0]], pair[1] ];
            query_string[pair[0]] = arr;
            // If third or later entry with this name
        } else {
            query_string[pair[0]].push(pair[1]);
        }
    }
    return query_string;
} ();

//defaults
var entryId = "";
var partnerId = "";
var playlistId = "";
var widgetType = ""; //entry or playlist. in case of entry - the playlist will be related
var uiconfId = 1 ; //this will come from KMS
var clipsToShow = 3; //amount of videos to show in playlist





// get embed config from location.hash
function getConfigFromLocationHash() {
	try {
		return JSON.parse(location.hash.substring(1));
	} catch(e) {
		kWidget.log('TR: Unable to parse JSON from location.hash');
		return {};
	}
}

// Merge config from location.hash & Embed the player
kWidget.embed(kWidget.extend({
	targetId: 'kPlayer',
	flashvars: {
		'topBarContainer.hover': true,
		'autoPlay': true,
		'trTitle.createTopBar': false,
		'trTranscript.plugin': true,
		'playlistAPI':{
			'mediaItemWidth': 110, // 443 (player width) / 4 items is 110 per item
			'MinClips': 3,
			'autoPlay': true,
			'autoContinue': true
		}
	}
},

        getConfigFromLocationHash()));

</script>
</body>
</html>