<html>
  <head>
    <meta name="generator" content="HTML Tidy for Windows (vers 14 February 2006), see www.w3.org">
	
    <title></title>
  </head>
  <body>
    <div style="width:680">
    <div class="playerContainer" style="float:left;width:480px;top:0px;left:0px;position:absolute;">
		<video class="persistentNativePlayer" id="vid1" width="480" height="267"
		 poster="http://cdn.kaltura.org/apis/html5lib/kplayer-examples/media/bbb480.jpg"
		 durationHint="33"
		 >
		 	<source src="http://cdn.kaltura.org/apis/html5lib/kplayer-examples/media/bbb_trailer_iphone.m4v" />
			<source src="http://cdn.kaltura.org/apis/html5lib/kplayer-examples/media/bbb400p.ogv" />
		</video>
	</div>
		<div id="companionTarget" style="float:right;width:180px;height:267px;border:solid thin black">
			Companion target
		</div>
	</div>
	<div style="clear:both"></div>
	    <h1>
      HTML5 ad timeline test
    </h1>
   	<br>Preroll video (30 seconds fish) <input id="preroll" type="text" size="40" value="http://cdn.kaltura.com/p/423851/sp/42385100/flvclipper/entry_id/1_8c3s1pvx/flavor/1_5slf6gab/a.mp4?novar=0"></input>
   	<a id="addPrerool" href="#">Update preroll video</a>
   	</br>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
 	<script src="../../../mwEmbedLoader.js?debug=true" type="text/javascript"></script>
 	<script type="text/javascript">
 		mw.setConfig( 'EmbedPlayer.EnableIpadHTMLControls', true);
 		mw.setConfig( 'EmbedPlayer.OverlayControls', false);
 		
 		mw.ready(function(){
 	 		var embedPlayer = $j('#vid1').get(0);
 	 		
 	 		$j( embedPlayer ).bind( 'openFullScreen', function(){
 	 			embedPlayer.$interface.append( 
 	 	 			'<span class="fullscreenOverlay" style="position:absolute;top:10px;' + 
 	 	 				'left:10px;color:red">fullscreen overlay</span>'
 	 	 	 	);
 	 		});
 	 		$j( embedPlayer ).bind( 'closeFullScreen', function(){
 	 			embedPlayer.$interface.find('.fullscreenOverlay').fadeOut('fast');
 	 		});
 	 		
 	 		$j( embedPlayer ).bind( 'monitorEvent', function(){
 	 	 		if( embedPlayer.$interface.find('.timeOverlay').length == 0 ){
 	 	 			embedPlayer.$interface.append(
 	 	 	 	 		'<span class="timeOverlay" style="position:absolute;top:200px;' + 
 	 	 	 				'left:10px;color:red"></span>' 
	 	 	 		);
 	 	 		} 	 			
 	 		});	
			

			// Alternativly to the monitorEvent you can use the mobileAdTimeline helper 
			// See structure of ad JSON in mw.MobileAdTimeline 
			mw.load( "mw.AdTimeline", function(){
		
				var updatePreRool = function( preRollUrl ){
					mw.addAdToPlayerTimeline( embedPlayer, 'preroll', 
		 	 	 		{ 
		 	 	 	 		'ads': [
				 	 	 	 	{
			 	 					'videoFile' : preRollUrl,
			 	 					'companions': [
			 	 		 	 	 		{
					 						'id' : 0,
					 						'html' : '<div style="background-color:#99F">Fish companion Ad</div>'
				 						}
				 					]
		 						}
		 					],
							'companionTargets': [
								{
		 							'elementid':'companionTarget'
		 						}
		 					]	 					
		 	 	 		}							
					)
	 			};
	 			// update the preroll
	 			updatePreRool( $j('#preroll').val() );
	 			
				// let the user update the preroll:
				$j('#addPrerool').click(function(){
					var _this = this;
					updatePreRool(  $j('#preroll').val() );
				});
				
				
	 			// Insert the overlay video
				mw.addAdToPlayerTimeline( embedPlayer, 'overlay', 
 	 	 	 		{ 
 	 	 	 	 		'ads': [
		 	 	 	 		{			 	 
	 	 	 					'companions': [
		 	 	 	 					{
			 							'id' : 1, 
			 							'html' : '<div style="background-color:#F99">Overlay Companion</div>'
									}
	 		 					],
	 	 	 	 	 			'nonLinear': [
	 	 			            	{
	 	 	 			            	'width' : 320,
	 	 	 			            	'height' : 30,
	 	 	 			            	'html' : '<div style="width:100%;height:100%;background-color:gray;font-size:large"> overlay Ad </div>'
	 	 			            	}
								]
		 	 	 	 		}
 	 					],
 	 			 		'start' : 5,
 	 	 	 			'frequency' : 10,
 	 	 	 			'timeout' : 5,
	 					'companionTargets': [
	 					 		{
 	 								'elementid':'companionTarget'
		 	 					}			
 	 	 	 			]
 	 	 	 		}
				);
			});
 		});
 	</script>
  </body>
</html>
