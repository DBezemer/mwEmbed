<!DOCTYPE HTML>
<html>
	<head>
		<title>Kdp Api Play From/To attributes</title>
		<script type="text/javascript" src="../../../tests/qunit/qunit-bootstrap.js"></script>
		<script type="text/javascript" src="../../../mwEmbedLoader.php"></script>
		<script type="text/javascript" src="../../../docs/js/doc-bootstrap.js"></script>
		<script type="text/javascript">
		// disable adaptive:
		mw.setConfig('Kaltura.UseAppleAdaptive', false );
		
		var kdp;
		function jsCallbackReady( playerId ) {
			console.log('jsCallback Ready', playerId );
			kdp = $( '#' + playerId )[0];

			kdp.addJsListener("playerPlayed", "runTest");
		}
		function runTest() {
			console.log( 'play time: ' + kdp.evaluate('{video.player.currentTime}') );
			console.log( 'start time: ' + toSeconds( $("#startTime").val() ) );
		}
		
		$( function() {
			$("#preview").click( function() {

				var startTime = $("#startTime").val(),
					endTime = $("#endTime").val();

				console.log('Start Time: ' + startTime + ', End Time: ' + endTime );

				startTime = toSeconds(startTime);
				endTime = toSeconds(endTime);

				kdp.setKDPAttribute("mediaProxy", "mediaPlayFrom", startTime );
				kdp.setKDPAttribute("mediaProxy", "mediaPlayTo", endTime );

				kdp.sendNotification("doPlay");
			});
		});

		var toSeconds = function(time) {
			var arr = time.split(":");
			var seconds = parseFloat( (arr[0] * 60) * 60 );
			seconds += parseFloat( arr[1] * 60 );
			seconds += parseFloat ( arr[2] );
			return seconds;
		};

		var toHHMMSS = function (sec) {
			var sec_numb    = parseInt(sec);
			var hours   = Math.floor(sec_numb / 3600);
			var minutes = Math.floor((sec_numb - (hours * 3600)) / 60);
			var seconds = sec_numb - (hours * 3600) - (minutes * 60);

			if (hours   < 10) {hours   = "0"+hours;}
			if (minutes < 10) {minutes = "0"+minutes;}
			if (seconds < 10) {seconds = "0"+seconds;}
			var time    = hours+':'+minutes+':'+seconds;
			return time;
		}
		</script>
		<!-- qunit-kaltura must come after qunit-bootstrap.js and after mwEmbedLoader.php and after any jsCallbackReady stuff-->
	<script type="text/javascript" src="resources/qunit-kaltura-bootstrap.js"></script>
	</head>
	<body>
		<h1>Play From Start Time To End Time</h1>
		<div id="kaltura_player" style="width:400px;height:330px"></div>
		<span id="kdoc-more-desc">
			<br>This demo highlights a preview starting at 10 seconds playing content till 30 seconds in the media timeline. You 
			can adjust in and out points in the customize tab.
		</span>
		<script>
		</script>
		<script>
			kWidget.featureConfig({
				'targetId': 'kaltura_player',
				'wid': '_243342',
				'uiconf_id' : '12905712',
				'entry_id' : '0_uka1msg4',
				'flashvars':{
					'docPlayToFrom': false,
					'mediaProxy.mediaPlayFrom': 10,
					'mediaProxy.mediaPlayTo': 30
				}
			});
		</script>
	</body>
</html>