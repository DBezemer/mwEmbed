<!doctype>
<html>
<head>
    <title>Reuters Insider</title>
    <script type="text/javascript" src="../../../../mwEmbedLoader.php"></script>
</head>
<body>
<div class="container" style="width: 100%;">
    <div id="kPlayer" style="width: 290px; height: 440px; float: left"></div>
    <div  style="width: auto;height:440px;position: inherit;background-color: #DDDDDD;">
        <div id="captionsContainer" style="width: 100%; height: 440px; " >

        </div>
    </div>
</div>
<script>


    //parse query string to an object
    var queryString = function () {
        var query_string = {};
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i=0;i<vars.length;i++) {
            var pair = vars[i].split("=");
            // If first entry with this name
            if (typeof query_string[pair[0]] === "undefined") {
                query_string[pair[0]] = pair[1];
                // If second entry with this name
            } else if (typeof query_string[pair[0]] === "string") {
                var arr = [ query_string[pair[0]], pair[1] ];
                query_string[pair[0]] = arr;
                // If third or later entry with this name
            } else {
                query_string[pair[0]].push(pair[1]);
            }
        }
        return query_string;
    } ();

    //defaults TR

    var entryId = "";
    var partnerId = 27017;
    var playlistId = "";
    var uiconfId = 28529602 ; //this will come from KMS
    var clipsToShow = 3; //amount of videos to show in playlist
    var omniturePn = "";
    var omnitureEud = "";
    var omnitureUuid = "";
    var widgetType = "";
    var playlistId = "1_smuhcro8";
    var startFrom = 0;


    var hashStr = window.location.hash.substring(1);
    var jsonConfig = {};
    try {
        jsonConfig = JSON.parse(hashStr);
    } catch( e ) {
        kWidget.log('TR: Unable to parse JSON from location.hash');
    }

    partnerId = jsonConfig.pid;
    playlistId = jsonConfig.cid;
    entryId = jsonConfig.mid;
    widgetType = jsonConfig.wtype;
    if(jsonConfig.startFrom){
        startFrom = jsonConfig.startFrom;
    }

    if(jsonConfig.uiconfId){
        uiconfId = jsonConfig.uiconfId;
    }
    if(jsonConfig.clipsToShow){
        clipsToShow = jsonConfig.clipsToShow;
    }
    //      example of overrideÃŸ
    //      http://localhost/html5.kaltura/mwEmbed/modules/tr/tests/dev/popup.html#{"pid":27017,"mid":"1_1611vudr","startFrom":0,"uuid":"omnitureUser","pn":"pmniturePn","bitrate":400,"eud":"omnitureEud","wtype":"omnitureWtype"}
    mw.setConfig('forceMobileHTML5', true);


    kWidget.embed({
        'targetId': 'kPlayer',
        'wid': '_'+partnerId,
        'uiconf_id' : uiconfId,
        'entry_id' : entryId,
        'flashvars': {
            'trTitle.plugin': true,
            "trTranscript": {
                "plugin": true,
                "targetId" : "captionsContainer"
            },
            "mediaProxy.mediaPlayFrom" : startFrom,

            'playlistAPI': {
//                'kpl0Id': playlistId,
                'MinClips': 3

            },
            "closedCaptions": {
                "plugin": true
            }


        }
    });

</script>
</body>
</html>
