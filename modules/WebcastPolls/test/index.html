<html>
<head>
    <title>polls demo</title>
    <script type="text/javascript" src="/html5.kaltura/mwEmbed/tests/qunit/qunit-bootstrap.js"></script>
    <script type="text/javascript" src="/html5.kaltura/mwEmbed/mwEmbedLoader.php"></script>
    <script type="text/javascript" src="/html5.kaltura/mwEmbed/docs/js/doc-bootstrap.js"></script>
    <style>
        .fwd{
            background-color: #72db7b;
        }
        .bwd{
            background-color: #db71db;
        }
    </style>
    <meta charset=UTF-8>
</head>
<body>
<h1>polls demo</h1>
<br>
<button onclick="toggleMenu()">openSlidesMenu</button>
<button onclick="seekTo(7073)">answerOnAir</button>
<button onclick="seekTo(143)">143</button>
<button class="bwd" onclick="seekRelative(-15)">-15s</button>
<button class="fwd" onclick="seekRelative(15)">+15s</button>
<button class="bwd" onclick="seekRelative(-30)">-30</button>
<button class="fwd" onclick="seekRelative(30)">+30s</button>
<button class="bwd" onclick="seekRelative(-180)">-3m</button>
<button class="fwd" onclick="seekRelative(180)">+3m</button>

<div id="kaltura_player" style="width: 885px; height: 630px;float: left;"></div>
<div id="qnaListHolder" style="width: 220px; height: 330px; float:left; float: left"></div>
<br style="clear: both;"/><br/>

<script>

	var qna = {
		'plugin': true,
		'qnaTargetId': 'qnaListHolder',
		'qnaPollingInterval': 5000,
		'onPage': true,
		'containerPosition': 'right',
		'moduleWidth': '200',
		'userId': "Shimi",
		'userRole': "userRole", //anonymousRole
		'allowNewQuestionWhenNotLive': true
	};

	var QueryString = function () {
		// This function is anonymous, is executed immediately and
		// the return value is assigned to QueryString!
		var query_string = {};
		var query = window.location.search.substring(1);
		var vars = query.split("&");
		for (var i = 0; i < vars.length; i++) {
			var pair = vars[i].split("=");
			// If first entry with this name
			if (typeof query_string[pair[0]] === "undefined") {
				query_string[pair[0]] = decodeURIComponent(pair[1]);
				// If second entry with this name
			} else if (typeof query_string[pair[0]] === "string") {
				var arr = [query_string[pair[0]], decodeURIComponent(pair[1])];
				query_string[pair[0]] = arr;
				// If third or later entry with this name
			} else {
				query_string[pair[0]].push(decodeURIComponent(pair[1]));
			}
		}
		return query_string;
	}();
	var paramFromUrl = function (key) {
		if (QueryString[key]) {
			this[key] = QueryString[key];
		}
	};

	var playerId = 39666321; //prod OOB
	//    var playerId = 15203553; //QA
	var wid = '_27017'; // prod
	//    var wid = '_5174'; // QA
	var ks = 'djJ8MjcwMTd89-r1FVs7XGJ1k-4depjlSnFiZB4_njT149nRHc54c0ChzC0tcVLnGlZnMBf0v4-WqcqM7V2kg7qNUw039ojsyUgU5y7-mkmp0utk-mX2UuTQBpGlbwWRnr4ziQkK9F6UOmoeK9Seue7nLCSmOKRBMtS8RxaGMA4sjb_Ba3WFL7fM7gIa0IoJVVqe3UdeESDp2Ew0zibbTNhT5RLKSfeC5NJF9HqWbhyvoT4DJ1A6TgwUh4HW0AINIRc9Qx7IlFT3QMrhw146P2tEpyEGt6WEg5FjQUMwIalXe8RPqQODoaj60CHnl_MoQAd9En7uJ3VUpKcY7l0ei4Edf4CdDU_Z9NYhP5j8Ycfi8hX6mdqrNpE=';
	var entry = "1_2e7u9qfm";

	paramFromUrl("ks");
	paramFromUrl("wid");
	paramFromUrl("entry");
	paramFromUrl("playerId");


	var kdp;
	kWidget.addReadyCallback(function (playerId) {
		kdp = document.getElementById(playerId);

		kdp.kBind('playerReady', function () {
			setTimeout(function () {
				kdp.sendNotification("doPlay");
			}, 1000)
		})
	});


	kWidget.featureConfig({
		'targetId': 'kaltura_player',
		'wid': wid,
		'uiconf_id': playerId,
		'flashvars': {
			'autoPlay': true,
			"dualScreen": {
				"plugin": true
			},
			"chapters": {
				"plugin": true
			},
			"topBarContainer": {
				"plugin": true
			},
			"sideBarContainer": {
				"plugin": true
			},
			"IframeCustomPluginCss1": "pin-chapters.css",
			'qna': qna,
			'ks': ks,
			"webcastPolls": {
				"plugin": true,
                "userId": "Eitan",
                "userRole": "unmoderatedAdminRole"
            },
			"EmbedPlayer.LiveCuepoints": true
		},
		'entry_id': entry// vod : 1_bzr97hax | live : 1_afjmm4ie
	});
	function seekTo(t) {
		kdp.sendNotification("doSeek", t);
	}
	function seekRelative(offset) {
		var currentPosition = kdp.evaluate("{video.player.currentTime}");
		kdp.sendNotification("doSeek", currentPosition + offset);
	}
	function openSlidesMenu() {
		var $iframe = $("#kaltura_player_ifp").contents();
		var sbc = $iframe.find('.sideBarContainer');
		sbc.addClass("pinned")
	}
	function closeSlidesMenu() {
		var $iframe = $("#kaltura_player_ifp").contents();
		var sbc = $iframe.find('.sideBarContainer');
		sbc.removeClass("pinned");
	}
	var menuOpen = false;
	function toggleMenu(){
        if(menuOpen){
        	this.closeSlidesMenu();
        }else{
        	this.openSlidesMenu();
        }
    }

</script>

</body>
</html>