<!DOCTYPE HTML>
<html>
<head>
<title>Mirriad In Video Ads </title>
<script type="text/javascript" src="../../../tests/qunit/qunit-bootstrap.js"></script>
<script type="text/javascript" src="../../../mwEmbedLoader.php"></script>
<script type="text/javascript" src="../../../docs/js/doc-bootstrap.js"></script>

<!-- qunit-kaltura must come after qunit-bootstrap.js and after mwEmbedLoader.php and after any jsCallbackReady stuff-->
<script type="text/javascript" src="../../KalturaSupport/tests/resources/qunit-kaltura-bootstrap.js"></script>
</head>
<body>
<img src="resources/mirriadLogo.png">
<h2> Mirriad Per User Targted In Video Ads </h2>

<div id="kdoc-more-desc">
Kaltura robust ad stitching technology is combined with Mirriad revolutionary in-video advertising 
technology to deliver per-user in-video advertising. Identify to the Ad server as
male, female or no Ads, and playback will reflect real time targeted in-video advertising:

	<ul class="cuetype nav nav-pills">
		<li>Loading ...</li>
	</ul>
</div>
<div style="width: 95%;display: inline-block;position: relative;"> 
		<div id="dummy" style="margin-top: 56.25%;"></div> <!--   /* 16:9 aspect ratio */ -->
		<div id="kaltura-player" style="position:absolute;top:0;left:0;left: 0;right: 0;bottom:0;">
				<div id="myVideoTarget" style="width:100%;height:100%"></div> 
		</div>
</div>
<div style="background-color:#eee;padding:5px;">Ad Brand: <span id="ad-info"></span></div>
<script>
	kWidget.embed({
		'targetId': 'kaltura-player',
		'wid': '_243342',
		'uiconf_id' : '21099702',
		'entry_id' : '0_3qlnvsw3',
		'flashvars': {
			'mediaSessionService':{
				'plugin': true,
				'socketLog': true,
				'guid': null
			},
			'mirriadMarkers': {
				'plugin': true,
				'cueType': 'Male',
				'cueTargets': {
					'None':{
						'entry': '0_53bc5gbe'
					},
					'Male': {
						'cueFile': 'resources/ZEE_NOKIA ADAVAILS.xml',
						'entry': '0_3qlnvsw3'
					},
					/*'female': {
					'cueFile':'resources/STV_DEMO_CORO_DEMO_7956-Female.xml',
					'entry': '0_9r40fzin'
				},*/
				},
				'iframeHTML5Js': 'resources/mirriadMarkers.js',
				'iframeHTML5Css': 'resources/mirriadMarkers.css'
			}
		}, 
		'readyCallback': function( playerId ){
			var kdp = $('#' + playerId )[0];
			kdp.kBind('mirriadMarker', function( itemObj ){
				$('#ad-info').text( itemObj.brand );
			});
			// build out menu: 
			var cueTargets = kdp.evaluate('{mirriadMarkers.cueTargets}');
			$('.cuetype').empty();
			$.each( cueTargets, function( indexType, cueTarget) {
				var $a = $('<a>').attr('href', '#').text( indexType );
				$a.click(function(){
					$('#ad-info').empty();
					kdp.setKDPAttribute( 'mirriadMarkers', 'cueType', indexType );
					// update dom:
					$('.cuetype').find( 'li' ).removeClass("active");
					$(this).parent().addClass("active");
					return false;
				})
				$li = $('<li>').append( $a );
				if( indexType ==  kdp.evaluate('{mirriadMarkers.cueType}') ){
					$li.addClass("active");
				}
				$('.cuetype').append( $li );
			})
		}
	})
</script>

</body>
</html>
