<!DOCTYPE HTML>
<html>
<head>
<title>Syndication VOD Entry Midroll </title>
<script type="text/javascript" src="../../../tests/qunit/qunit-bootstrap.js"></script>
<script type="text/javascript" src="../../../mwEmbedLoader.php"></script>
<script type="text/javascript" src="../../../docs/js/doc-bootstrap.js"></script>
<script>
	// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript
	function s4() {
		return Math.floor((1 + Math.random()) * 0x10000)
			.toString(16)
			.substring(1);
	};
	function guid() {
		return s4() + s4() + '-' + s4() + '-' + s4() + '-' +
			s4() + '-' + s4() + s4() + s4();
	}
</script>
</head>
<body>
<div style="float:left">
<h3> Syndication VOD Entry Midroll </h3>
Midroll starts at 20 seconds<br>
<video id="vid" style="width:600px;height:342px" controls autoplay></video>
</div>
<script>
	var instaceGuid = guid() ;
	var src = "../../../services.php?service=mediaSession&wid=_243342&uiconf_id=6470132&entry_id=0_c0r624gh";
	document.getElementById( 'vid' ).setAttribute('src', src + '&guid=' + guid() );
</script>

<div style="overflow:hidden;padding-left:10px;"> 
<h3> Media State Events</h3>
<textarea id="medialog" style="width:96%;height:342px;"></textarea>
</div>


<script> 
	function logMessage(msg){
		$( '#medialog' ).append( msg + "\n" );
	}
	// register the guid on the page: 
	logMessage( 'Open Connection: ' + instaceGuid );
	// MediaState relay ( not needed for syndication mode)
	var host = window.location.hostname;
	var conn = new WebSocket('ws://' + host + ':8080');
	conn.onopen = function(e) {
		logMessage("Connection established!");
	};
	conn.onerror = function(e){
		logMessage("Connection failed!");
	}
	conn.onclose = function(e){
		logMessage("Connection closed!");
	}
	
	conn.onmessage = function(e) {
		logMessage(e.data);
	};
</script>
</body>
</html>